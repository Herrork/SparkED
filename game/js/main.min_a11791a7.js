var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(r){n=[6,r],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},acg;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isReady=!1,e.eventDic={},e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.onCreationComplete,e),e}return __extends(e,t),e.prototype.onCreationComplete=function(t){this.initComponent(),this.initData(),this.initListener(),this.isReady=!0,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreationComplete,this)},e.prototype.initComponent=function(){},e.prototype.initData=function(){},e.prototype.initListener=function(){},e.prototype.addEvent=function(t,e,n,r){var i={};i.target=t,i.type=e,i.callBack=n,i.thisObject=r,t&&(t.addEventListener(e,n,r),this.eventDic[t.hashCode+e]=i)},e.prototype.addClickEvent=function(t,e,n){var r={};r.target=t,r.type=egret.TouchEvent.TOUCH_BEGIN,r.thisObject=n,r.callFunc=this.onTouchBegin,r.thisCall=this,t&&(t.addEventListener(r.type,this.onTouchBegin,this),this.eventDic[t.hashCode+r.type]=r);var i={};i.target=t,i.type=egret.TouchEvent.TOUCH_END,i.callBack=e,i.thisObject=n,i.callFunc=this.onTouchEnd,i.thisCall=this,t&&(t.addEventListener(i.type,this.onTouchEnd,this),this.eventDic[t.hashCode+i.type]=i);var o={};o.target=t,o.type=egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,o.thisObject=n,o.callFunc=this.onTouchReleaseOutSide,o.thisCall=this,t&&(t.addEventListener(o.type,this.onTouchReleaseOutSide,this),this.eventDic[t.hashCode+o.type]=o)},e.prototype.onTouchBegin=function(t){this.touchBeginTaret=t.target,egret.Tween.get(t.target).to({scaleX:.9,scaleY:.9},50)},e.prototype.onTouchEnd=function(t){var e=this,n=t.target;this.touchBeginTaret==n&&(this.touchBeginTaret=null,egret.Tween.get(n).to({scaleX:1,scaleY:1},50).call(function(){for(var t in e.eventDic){var r=e.eventDic[t];r.target==n&&r.type==egret.TouchEvent.TOUCH_END&&r.callBack.call(r.thisObject)}},this))},e.prototype.onTouchReleaseOutSide=function(t){this.touchBeginTaret==t.target&&(this.touchBeginTaret=null,t.target.scaleX=1,t.target.scaleY=1)},e.prototype.removeAllEvent=function(){var t;for(var e in this.eventDic)t=this.eventDic[e],null!=t.target&&(t.target.removeEventListener(t.type,t.callBack,t.thisObject),t.target.removeEventListener(t.type,t.callFunc,t.thisCall)),delete this.eventDic[e];this.eventDic={}},e.prototype.dispos=function(t){void 0===t&&(t=!1),this.removeAllEvent(),this.touchBeginTaret=null,this.parent&&this.parent.removeChild(this)},e}(eui.Component);t.BaseView=e,__reflect(e.prototype,"acg.BaseView")}(acg||(acg={}));var adapter;!function(t){var e=function(){function e(){}return e.debug=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=this.getMsg(t,e);console.debug.apply(console,[i].concat(n))},e.info=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=this.getMsg(t,e);console.info.apply(console,[i].concat(n))},e.warn=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=this.getMsg(t,e);console.warn.apply(console,[i].concat(n))},e.error=function(t,e){void 0===e&&(e="");for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=this.getMsg(t,e);console.error.apply(console,[i].concat(n))},e.getMsg=function(e,n){return n?t.Util.getCurTime()+"["+e+"] "+n:t.Util.getCurTime()+" msg "+e},e}();t.Logger=e,__reflect(e.prototype,"adapter.Logger")}(adapter||(adapter={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,r){function i(t){e.call(r,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(r))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(r,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var u=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(r,generateJSON.paths[t])},this):RES.getResByUrl(u,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(r,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var adapter;!function(t){var e=function(){function t(t,e,n){this.trackIndex=0,this.name="",this.loop=!1,this.trackIndex=t,this.name=e,this.loop=n}return t}();__reflect(e.prototype,"AnimationInfo");var n=function(t){function e(){var n=t.call(this)||this;if(e._instance)throw"Clock 是单例，请使用 Clock.instance";e._instance=n;var r=n,i=Date.now();if(window.requestAnimationFrame){var o=function(){var t=Date.now()-i;i+=t,r.onFrame(t),window.requestAnimationFrame(o)};window.requestAnimationFrame(o)}else setInterval(function(){var t=Date.now()-i;i+=t,r.onFrame(t)},1e3/60);return n}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||new e,e._instance},enumerable:!0,configurable:!0}),e.prototype.onFrame=function(t){t>200||this.advanceTime(t/1e3)},e}(dragonBones.WorldClock);__reflect(n.prototype,"Clock");var r=function(r){function i(){var t=r.call(this)||this;return t.mArmature=null,t.mArmatureDisplay=null,t.mFactory=null,t.mState=null,t.mAutoDispose=!0,t.mSkinName="default",t.mHasSetAnimation=!1,t.mAniInfos=[],t.mTypeToResolveDict={},t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t._onRemove,t),t}return __extends(i,r),i.prototype.addAnimationStateListener=function(t){this.mStatListener=t,this._addDragonBoneEvent()},i.prototype.removeAnimationStateListener=function(t){this.mStatListener=null,this._removeDragonBoneEvent()},i.prototype._onRemove=function(){this.mAutoDispose,this._removeDragonBoneEvent()},i.prototype._addDragonBoneEvent=function(){var t=this;t.egretArmatureDisplay&&(t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.FRAME_EVENT)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.FRAME_EVENT,t._animationEventHandler,t),t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.COMPLETE)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,t._animationEventHandler,t),t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.START)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.START,t._animationEventHandler,t),t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.LOOP_COMPLETE)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,t._animationEventHandler,t))},i.prototype._removeDragonBoneEvent=function(){var t=this;t.egretArmatureDisplay&&(t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.FRAME_EVENT,t._animationEventHandler,t),t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.COMPLETE,t._animationEventHandler,t),t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.START,t._animationEventHandler,t),t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE,t._animationEventHandler,t))},i.prototype._animationEventHandler=function(t){t&&this._resolveAll(t.type,t)},i.init=function(){t.Scheduler.frameCall(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3)},this,-1)},i.prototype.initWithName=function(t,e){return void 0===e&&(e=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,this.initWithFile2(t+"_ske",t+"_tex",e)];case 1:return n.sent(),[2]}})})},i.prototype.initWithFile3=function(t,e,n,r,i,o,a){return void 0===o&&(o="default"),void 0===a&&(a=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(s){switch(s.label){case 0:return[4,this.initWithFile2(t,e,a)];case 1:return s.sent(),this.setSkin(o),this.setAnimation(n,r,i),[2]}})})},i.prototype.initWithFile2=function(e,r,i){return void 0===i&&(i=!0),__awaiter(this,void 0,void 0,function(){var o,a,s,u,c,l,h,f;return __generator(this,function(m){switch(m.label){case 0:if(t.AssetsMgr.getRes(e+"_json")&&t.AssetsMgr.getRes(r+"_json")&&t.AssetsMgr.getRes(r+"_png"))return[3,2];o=!1;try{a=t.AssetsMgr.getGroupByName(e+"_db"),o=a&&a.length>0}catch(p){}return o||t.AssetsMgr.createGroup(e+"_db",[e+"_json",r+"_json",r+"_png"]),[4,t.AssetsMgr.loadGroup(e+"_db")];case 1:m.sent(),m.label=2;case 2:for(s=t.AssetsMgr.getRes(e+"_json"),u=t.AssetsMgr.getRes(r+"_json"),c=t.AssetsMgr.getRes(r+"_png"),this.mFactory=new dragonBones.EgretFactory,this.mFactory.parseDragonBonesData(s),this.mFactory.parseTextureAtlasData(u,c),this.mArmatureDisplay=this.mFactory.buildArmatureDisplay(e.substr(0,e.indexOf("_ske"))),this.mAutoDispose=i,this.mArmature=this.mArmatureDisplay.armature,this.mArmature.clock=n.instance,this.addChild(this.mArmatureDisplay),l=0,h=Object.keys(this.mTypeToResolveDict);l<h.length;l++)f=h[l],this._listenEvent(f);return this._addDragonBoneEvent(),this.setSkin(this.mSkinName),this.mAniInfos.length>0&&this.setAnimation(this.mAniInfos[0].trackIndex,this.mAniInfos[0].name,this.mAniInfos[0].loop),[2]}})})},Object.defineProperty(i.prototype,"armatureDisplay",{get:function(){return this.mArmatureDisplay},set:function(t){this.mArmatureDisplay=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isResLoaded",{get:function(){return this.mArmature?!0:!1},enumerable:!0,configurable:!0}),i.prototype.setTimeScale=function(t){var e=this;e.mArmature&&e.mArmature.animation&&(e.mArmature.animation.timeScale=t)},i.prototype.getAnimationNames=function(){for(var t=[],e=this.mAniInfos,n=0,r=e.length;r>n;n++)t.push(e[n].name);return t},i.prototype.setAnimation=function(t,n,r){if(!this.mArmature){this.mAniInfos=[];var i=new e(t,n,r);return this.mAniInfos.push(i),null}return this.mHasSetAnimation&&this.pause(),"boolean"==typeof r?this.mState=this.mArmature.animation.play(n,r?0:1):"number"==typeof r&&(this.mState=this.mArmature.animation.play(n,r)),this.mHasSetAnimation=!0,this.mState},i.prototype.addAnimation=function(e,n,r,i,o){return __awaiter(this,void 0,void 0,function(){var a,s;return __generator(this,function(u){switch(u.label){case 0:return[4,this.waitEvent(t.ArmatureAnimation.EVENT_COMPLETE)];case 1:return u.sent(),a=this,s=a.mArmature&&a.mArmature.animation?a.mArmature.animation.lastAnimationName:null,s==n&&(o&&this.setMix(r,o),this.setAnimation(e,r,i)),[2]}})})},Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){var t=this.getCurrent();return t?t.lastAnimationName:null},enumerable:!0,configurable:!0}),i.prototype.setSkin=function(t){if(!t)return!1;if(t=t.trim(),""===t&&(t="default"),this.mSkinName=t,this.mFactory&&this.mArmature&&this.mArmature.armatureData){this.mArmature.armatureData.getSkin(t)}return!0},i.prototype.disableBatch=function(){var t=this;t.mArmature&&t.mArmature.display&&t.mArmature.display.disableBatch()},i.prototype.findBone=function(t){var e=this;return e.mArmature?e.mArmature.getBone(t):null},i.prototype.findSlot=function(t){var e=this;return e.mArmature?e.mArmature.getSlot(t):null},i.prototype.setMix=function(t,e,n){var r=this;return r.mArmature&&r.mArmature.animation?r.mArmature.animation.fadeIn(t,e,n):void 0},i.prototype.dispose=function(){this.mArmature&&(this.mArmature.dispose(),this.mArmature=null);for(var t=0,e=Object.keys(this.mTypeToResolveDict);t<e.length;t++){var n=e[t];this._resolveAll(n)}this.mTypeToResolveDict={}},i.prototype.waitEvent=function(t){var e=this;return new Promise(function(n,r){e.mTypeToResolveDict[t]||(e.mTypeToResolveDict[t]=[],e._listenEvent(t)),e.mTypeToResolveDict[t].push(n)})},Object.defineProperty(i.prototype,"egretArmatureDisplay",{get:function(){var t=this;return t.mArmature&&t.mArmature.display?t.mArmature.display:null},enumerable:!0,configurable:!0}),i.prototype._listenEvent=function(t){var e=this;t=this._isEventStringType(t)?t:i.FRAME_EVENT,this.mArmature&&(t==i.FRAME_EVENT&&this.egretArmatureDisplay.hasEventListener(i.FRAME_EVENT)||this.egretArmatureDisplay.addEventListener(t,function(n){e._resolveAll(t,n)},this))},i.prototype._resolveAll=function(t,e){var n=this,r=e&&e.eventObject?e.eventObject.name:null;if(n.mStatListener&&e){var i=e.eventObject&&e.eventObject.name?e.eventObject.name:e.type;n.mStatListener.event(e,i)}r&&""!=r.trim()&&n.mTypeToResolveDict[r]&&n._resolveByEventType(r,e),n._resolveByEventType(t,e)},i.prototype._resolveByEventType=function(t,e){if(this.mTypeToResolveDict[t]){for(var n=0,r=this.mTypeToResolveDict[t].length;r>n;n++)this.mTypeToResolveDict[t][n](e);this.mTypeToResolveDict[t]=void 0}},i.prototype._isEventStringType=function(t){var e=[dragonBones.EventObject.START,dragonBones.EventObject.LOOP_COMPLETE,dragonBones.EventObject.COMPLETE,dragonBones.EventObject.FADE_IN,dragonBones.EventObject.FADE_IN_COMPLETE,dragonBones.EventObject.FADE_OUT,dragonBones.EventObject.FADE_OUT_COMPLETE,dragonBones.EventObject.FRAME_EVENT,dragonBones.EventObject.SOUND_EVENT];return-1==e.indexOf(t)?!1:!0},i.prototype.cacheFrameRate=function(t){void 0===t&&(t=24),this.mArmature&&(this.mArmature.cacheFrameRate=t)},i.prototype.getCurrent=function(){return this.mArmature?this.mArmature.animation:null},i.prototype.pause=function(){this.mState&&this.mState.stop()},i.prototype.resume=function(){this.mState&&this.mState.play()},i.prototype.reset=function(){this.mArmature&&this.mArmature.animation&&this.mArmature.animation.reset()},i.EVENT_START=dragonBones.EventObject.START,i.EVENT_COMPLETE=dragonBones.EventObject.COMPLETE,i.FADE_IN=dragonBones.EventObject.FADE_IN,i.FADE_IN_COMPLETE=dragonBones.EventObject.FADE_IN_COMPLETE,i.FADE_OUT=dragonBones.EventObject.FADE_OUT,i.FADE_OUT_COMPLETE=dragonBones.EventObject.FADE_OUT_COMPLETE,i.LOOP_COMPLETE=dragonBones.EventObject.LOOP_COMPLETE,i.FRAME_EVENT=dragonBones.EventObject.FRAME_EVENT,i.SOUNT_EVENT=dragonBones.EventObject.SOUND_EVENT,i}(egret.DisplayObjectContainer);t.ArmatureAnimation=r,__reflect(r.prototype,"adapter.ArmatureAnimation")}(adapter||(adapter={}));var adapter;!function(t){var e=function(){function e(){}return e.loadConfigRaw=function(n,r,i,o,a){RES.loadConfig(n,r).then(function(){o()})["catch"](function(s){i++,60>i?t.Scheduler.delayCall(1e3,function(){e.loadConfigRaw(n,r,i,o,a)},null):a()})},e.loadConfig=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,new Promise(function(r,i){e.loadConfigRaw(t,n,0,r,i)})]})})},e.loadGroup=function(e,n,r){return RES.loadGroup(e,n,r)["catch"](function(e){t.Logger.error("AssetsMgr","loadGroup error : "+(e?e.message:e))})},e.isGroupLoaded=function(t){return RES.isGroupLoaded(t)},e.getGroupByName=function(t){return RES.getGroupByName(t)},e.createGroup=function(t,e,n){return RES.createGroup(t,e,n)},e.hasRes=function(t){return RES.hasRes(t)},e.getRes=function(t){return RES.getRes(t)},e.getResAsync=function(e){var n=RES.getResAsync(e);return n?n["catch"](function(e){t.Logger.error("AssetsMgr","getResAsync error : "+(e?e.message:e))}):null},e.getResByUrl=function(t,e,n,r){RES.getResByUrl(t,e,n,r)},e.destroyRes=function(t,e){var n=RES.destroyRes(t,e);return n},e.addEventListener=function(t,e,n,r,i){RES.addEventListener(t,e,n,r,i)},e.removeEventListener=function(t,e,n,r){RES.removeEventListener(t,e,n,r)},e.getResourceInfo=function(t){return RES.getResourceInfo(t)},e}();t.AssetsMgr=e,__reflect(e.prototype,"adapter.AssetsMgr")}(adapter||(adapter={}));var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return acg.LayerManager.init(this.stage),[4,this.loadResource()];case 1:return n.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=n.sent(),[4,platform.login()];case 3:return n.sent(),[4,platform.getUserInfo()];case 4:return e=n.sent(),console.log(e),this.addJavaFunc(),[2]}})})},e.prototype.addJavaFunc=function(){egret.ExternalInterface.addCallback("sendToJS",function(t){alert(t)})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return n.sent(),this.stage.removeChild(t),[3,5];case 4:return e=n.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var r=new eui.Theme("resource/default.thm.json",t.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){acg.LayerManager.start()},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e.prototype.onButtonClick=function(t){this.lightDb.setAnimation(0,"zhaomushi",!0),egret.ExternalInterface.call("takePhoto","message from JS")},e}(eui.UILayer);__reflect(Main.prototype,"Main");var adapter;!function(t){var e=function(){function t(){}return t}();__reflect(e.prototype,"FrameCaller");var n=function(){function n(){}return n._timerCall=function(t,e,r,i){var o=new egret.Timer(t,i),a=n.timerId++;return n.timerDict[a]=o,1==i?o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){e.apply(r),n.timerDict[a]=void 0},this):(o.addEventListener(egret.TimerEvent.TIMER,e,r),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){n.timerDict[a]=void 0},this)),o.start(),a},n.delayCall=function(e,r,i){return r?n._timerCall(e,r,i,1):(t.Logger.warn(n.LOG_TAG,"Delay call with a function undefined or null!"),-1)},n.loopCall=function(e,r,i,o){return r?n._timerCall(e,r,i,o):(t.Logger.warn(n.LOG_TAG,"Loop call with a function undefined or null!"),-1)},n.cancelTimeCall=function(e){return n.timerDict[e]?(n.timerDict[e].stop(),n.timerDict[e]=void 0,void delete n.timerDict[e]):void t.Logger.warn(n.LOG_TAG,"Cancel a time call which is not exist!")},n.cancelAllTimeCall=function(){for(var t in n.timerDict)n.timerDict[t].stop();n.timerDict={}},n._onEnterFrame=function(t){var e=Date.now(),r=e-n.lastFrameTime;n.lastFrameTime=e;var i=[],o=0;for(var a in n.frameCallerDict){o++;var s=n.frameCallerDict[a];s.obj?s.func.apply(s.obj,[r]):s.func(r),s.loopCount>0&&s.curLoop++,s.loopCount>0&&s.loopCount==s.curLoop&&i.push(a)}if(o==i.length)return void n.cancelAllFrameCall();for(var u=0,c=i.length;c>u;u++){var a=i[u];n.frameCallerDict[a]=void 0,delete n.frameCallerDict[a]}},n.frameCall=function(r,i,o){if(!r)return t.Logger.warn(n.LOG_TAG,"Frame call with a function undefined or null!"),-1;var a=new e;a.func=r,a.obj=i,a.loopCount=o,a.curLoop=0;var s=n.frameCallerId++;return n.frameCallerDict[s]=a,n.displayObj||(n.displayObj=new egret.DisplayObject),n.isListenToFrameEvent||(n.lastFrameTime=Date.now(),n.displayObj.addEventListener(egret.Event.ENTER_FRAME,this._onEnterFrame,this),n.isListenToFrameEvent=!0),s},n.waitForTime=function(t){return __awaiter(this,void 0,void 0,function(){var e,r=this;return __generator(this,function(i){return e=0,[2,new Promise(function(i,o){var a=n.frameCall(function(r){e+=r,e>=t&&(n.cancelFrameCall(a),i(e))},r,-1)})]})})},n.cancelFrameCall=function(e){return n.frameCallerDict[e]?(n.frameCallerDict[e]=void 0,void delete n.frameCallerDict[e]):void t.Logger.warn(n.LOG_TAG,"Cancel a frame call which is not exist!")},n.cancelAllFrameCall=function(){n.displayObj&&(n.displayObj.removeEventListener(egret.Event.ENTER_FRAME,this._onEnterFrame,this),n.isListenToFrameEvent=!1),n.frameCallerDict={}},n.LOG_TAG="Scheduler",n.timerId=1,n.timerDict={},n.frameCallerId=1,n.frameCallerDict={},n.displayObj=null,n.isListenToFrameEvent=!1,n.lastFrameTime=0,n.mSlowCount=0,n.mNormalCount=0,n.mFrameRate=0,n}();t.Scheduler=n,__reflect(n.prototype,"adapter.Scheduler")}(adapter||(adapter={}));var adapter;!function(t){var e=function(){function e(){}return e.getUserHead=function(t){return"avatar_head_"+(Number(t)%7+1)+"_png"},e.uuid=function(t,n){var r=e.CHARS,i=[];if(n=n||r.length,t)for(var o=0;t>o;o++)i[o]=r[0|Math.random()*n];else{i[8]=i[13]=i[18]=i[23]="-",i[14]="4";for(var o=0;36>o;o++)if(!i[o]){var a=0|16*Math.random();i[o]=r[19==o?3&a|8:a]}}return i.join("")},e.uuidFast=function(){for(var t=e.CHARS,n=new Array(36),r=0,i=0;36>i;i++)if(8==i||13==i||18==i||23==i)n[i]="-";else if(14==i)n[i]="4";else{2>=r&&(r=33554432+16777216*Math.random()|0);var o=15&r;r>>=4,n[i]=t[19==i?3&o|8:o]}return n.join("")},e.string2Number=function(t){return t&&+t==+t?+t:0},e.string2Boolean=function(t){return t?"true"==t?!0:"false"==t?!1:+t?!0:!1:!1},e.isArray=function(t){return"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)},e.isObject=function(t){return"object"==typeof t&&"[object Array]"!==Object.prototype.toString.call(t)},e.isString=function(t){return"string"==typeof t||"[object String]"==Object.prototype.toString.call(t)},e.isFunction=function(t){return"[object Function]"===Object.prototype.toString.call(t)},e.isRealNum=function(t){return""===t||null==t?!1:isNaN(t)?!1:!0},e.getMovieClip=function(e,n,r){var i=t.AssetsMgr.getRes(e),o=t.AssetsMgr.getRes(n),a=new egret.MovieClipDataFactory(i,o),s=new egret.MovieClip(a.generateMovieClipData(r));return s},e.formatNumberWithSplit=function(t){var e=~~t;if(isNaN(e))return"";var n=e+"",r=n.length,i="";if(r>3){var o,a=Math.ceil(r/3)-1;o=r%3==0?3:r%3,i=n.substring(0,o);for(var s=0;a>s;s++)i+=","+n.substring(o+3*s,o+3*(s+1))}else i=n;return i},e.random=function(t,e){if(t==e)return t;var n=e>t?t:e,r=t>e?t:e;return n+Math.floor(Math.random()*(r-n))},e.getRandomWeightIndex=function(t){if(0===t.length)return-1;if(1===t.length)return 0;var n=e.getArrSum(t);if(!n)return-1;for(var r=e.random(1,n+1),i=0,o=0,a=0;a<t.length;a++){if(o+=t[a],r>=i&&o>=r)return a;i=o}return-1},e.getArrSum=function(t){for(var n=0,r=0;r<t.length;r++){var i=t[r];if(!e.isRealNum(i))return null;n+=i}return n},e.secondsToDHMS=function(t){t=Math.max(0,t);var e=Math.floor(t%60),n=Math.floor(t/60)%60,r=Math.floor(t/3600)%24,i=Math.floor(t/86400);return{day:i,hour:r,min:n,sec:e}},e.formatTimeDHMS=function(t){var e=t.day,n=t.hour,r=t.min,i=t.sec;return{day:""+e,hour:10>n?"0"+n:""+n,min:10>r?"0"+r:""+r,sec:10>i?"0"+i:""+i}},e.formatDate=function(t){var e=new Date(t),n=e.getFullYear()+"-",r=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",i=e.getDate()<10?"0"+e.getDate():e.getDate();return n+r+i},e.formatDateNo_=function(t){var e=new Date(t),n=e.getFullYear()+"",r=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"",i=e.getDate()<10?"0"+e.getDate():e.getDate();return Number(n+r+i)},e.getCurTime=function(){return(new Date).toLocaleTimeString()},e.getRemainTimeArr=function(t){var e=[],n=Math.floor(t/86400),r=Math.floor(t%86400/3600),i=Math.floor(t%86400%3600/60),o=Math.floor(t%86400%3600%60);return e=[n,r,i,o]},e.formatTimeHMS=function(t){t=Math.max(0,t);var e=Math.floor(t%60),n=Math.floor(t/60)%60,r=Math.floor(t/3600);return(10>r?"0"+r:""+r)+":"+(10>n?"0"+n:""+n)+":"+(10>e?"0"+e:""+e)},e.formatTimeHM=function(t){t=Math.max(0,t);var e=Math.floor(t/60)%60,n=Math.floor(t/3600);return(10>n?"0"+n:""+n)+":"+(10>e?"0"+e:""+e)},e.formatTimeMS=function(t){t=Math.max(0,t);var e=Math.floor(t%60),n=Math.floor(t/60);return(10>n?"0"+n:""+n)+":"+(10>e?"0"+e:""+e)},e.setGrey=function(t){if(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n=new egret.ColorMatrixFilter(e);t.filters=[n]}},e.canceGrey=function(t){t&&t.filters&&(t.filters.length=0)},e.formatBigNumber=function(t,e){void 0===e&&(e=0);var n=t+"",r=n.length,i="",o="";if(r>=13)t/=1e12,o="T";else if(r>=10)t/=1e9,o="B";else if(r>=7)t/=1e6,o="M";else if(r>=5)t/=1e4,o="W";else{if(!(r>=4))return this.formatNumberWithSplit(t);t/=1e3,o="K"}return i=e>=0?t.toFixed(e):Math.floor(100*t)/100+"",parseFloat(i)+o},e.formatBigNumberZh_cn=function(t,e){void 0===e&&(e=0);var n=t+"",r=n.length,i="",o="";if(r>=13)t/=1e12,o="T";else if(r>=10)t/=1e9,o="B";else if(r>=7)t/=1e6,o="M";else if(r>=5)t/=1e4,o="万";else{if(!(r>=4))return this.formatNumberWithSplit(t);t/=1e3,o="K"}return i=e>=0?t.toFixed(e):Math.floor(100*t)/100+"",parseFloat(i)+o},e.removeFromParent=function(t){t&&t.parent?t.parent.removeChild(t):console.log("移除对象失败----------------------------------------")},e.md5=function(t){function e(t,e){return t<<e|t>>>32-e}function n(t,e){var n,r,i,o,a;return i=2147483648&t,o=2147483648&e,n=1073741824&t,r=1073741824&e,a=(1073741823&t)+(1073741823&e),n&r?2147483648^a^i^o:n|r?1073741824&a?3221225472^a^i^o:1073741824^a^i^o:a^i^o}function r(t,e,n){return t&e|~t&n}function i(t,e,n){return t&n|e&~n}function o(t,e,n){return t^e^n}function a(t,e,n){return e^(t|~n)}function s(t,i,o,a,s,u,c){return t=n(t,n(n(r(i,o,a),s),c)),n(e(t,u),i)}function u(t,r,o,a,s,u,c){return t=n(t,n(n(i(r,o,a),s),c)),n(e(t,u),r)}function c(t,r,i,a,s,u,c){return t=n(t,n(n(o(r,i,a),s),c)),n(e(t,u),r)}function l(t,r,i,o,s,u,c){return t=n(t,n(n(a(r,i,o),s),c)),n(e(t,u),r)}function h(t){for(var e,n=t.length,r=n+8,i=(r-r%64)/64,o=16*(i+1),a=Array(o-1),s=0,u=0;n>u;)e=(u-u%4)/4,s=u%4*8,a[e]=a[e]|t.charCodeAt(u)<<s,u++;return e=(u-u%4)/4,s=u%4*8,a[e]=a[e]|128<<s,a[o-2]=n<<3,a[o-1]=n>>>29,a}function f(t){var e,n,r="",i="";for(n=0;3>=n;n++)e=t>>>8*n&255,i="0"+e.toString(16),r+=i.substr(i.length-2,2);return r}function m(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);128>r?e+=String.fromCharCode(r):r>127&&2048>r?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}var p,d,g,v,E,y,_,A,T,C=Array(),b=7,O=12,S=17,w=22,R=5,L=9,D=14,M=20,B=4,F=11,j=16,I=23,N=6,P=10,k=15,x=21;for(t=m(t),C=h(t),y=1732584193,_=4023233417,A=2562383102,T=271733878,p=0;p<C.length;p+=16)d=y,g=_,v=A,E=T,y=s(y,_,A,T,C[p+0],b,3614090360),T=s(T,y,_,A,C[p+1],O,3905402710),A=s(A,T,y,_,C[p+2],S,606105819),_=s(_,A,T,y,C[p+3],w,3250441966),y=s(y,_,A,T,C[p+4],b,4118548399),T=s(T,y,_,A,C[p+5],O,1200080426),A=s(A,T,y,_,C[p+6],S,2821735955),_=s(_,A,T,y,C[p+7],w,4249261313),y=s(y,_,A,T,C[p+8],b,1770035416),T=s(T,y,_,A,C[p+9],O,2336552879),A=s(A,T,y,_,C[p+10],S,4294925233),_=s(_,A,T,y,C[p+11],w,2304563134),y=s(y,_,A,T,C[p+12],b,1804603682),T=s(T,y,_,A,C[p+13],O,4254626195),A=s(A,T,y,_,C[p+14],S,2792965006),_=s(_,A,T,y,C[p+15],w,1236535329),y=u(y,_,A,T,C[p+1],R,4129170786),T=u(T,y,_,A,C[p+6],L,3225465664),A=u(A,T,y,_,C[p+11],D,643717713),_=u(_,A,T,y,C[p+0],M,3921069994),y=u(y,_,A,T,C[p+5],R,3593408605),T=u(T,y,_,A,C[p+10],L,38016083),A=u(A,T,y,_,C[p+15],D,3634488961),_=u(_,A,T,y,C[p+4],M,3889429448),y=u(y,_,A,T,C[p+9],R,568446438),T=u(T,y,_,A,C[p+14],L,3275163606),A=u(A,T,y,_,C[p+3],D,4107603335),_=u(_,A,T,y,C[p+8],M,1163531501),y=u(y,_,A,T,C[p+13],R,2850285829),T=u(T,y,_,A,C[p+2],L,4243563512),A=u(A,T,y,_,C[p+7],D,1735328473),_=u(_,A,T,y,C[p+12],M,2368359562),y=c(y,_,A,T,C[p+5],B,4294588738),T=c(T,y,_,A,C[p+8],F,2272392833),A=c(A,T,y,_,C[p+11],j,1839030562),_=c(_,A,T,y,C[p+14],I,4259657740),y=c(y,_,A,T,C[p+1],B,2763975236),T=c(T,y,_,A,C[p+4],F,1272893353),A=c(A,T,y,_,C[p+7],j,4139469664),_=c(_,A,T,y,C[p+10],I,3200236656),y=c(y,_,A,T,C[p+13],B,681279174),T=c(T,y,_,A,C[p+0],F,3936430074),A=c(A,T,y,_,C[p+3],j,3572445317),_=c(_,A,T,y,C[p+6],I,76029189),y=c(y,_,A,T,C[p+9],B,3654602809),T=c(T,y,_,A,C[p+12],F,3873151461),A=c(A,T,y,_,C[p+15],j,530742520),_=c(_,A,T,y,C[p+2],I,3299628645),y=l(y,_,A,T,C[p+0],N,4096336452),T=l(T,y,_,A,C[p+7],P,1126891415),A=l(A,T,y,_,C[p+14],k,2878612391),_=l(_,A,T,y,C[p+5],x,4237533241),y=l(y,_,A,T,C[p+12],N,1700485571),T=l(T,y,_,A,C[p+3],P,2399980690),A=l(A,T,y,_,C[p+10],k,4293915773),_=l(_,A,T,y,C[p+1],x,2240044497),y=l(y,_,A,T,C[p+8],N,1873313359),T=l(T,y,_,A,C[p+15],P,4264355552),A=l(A,T,y,_,C[p+6],k,2734768916),_=l(_,A,T,y,C[p+13],x,1309151649),y=l(y,_,A,T,C[p+4],N,4149444226),T=l(T,y,_,A,C[p+11],P,3174756917),A=l(A,T,y,_,C[p+2],k,718787259),_=l(_,A,T,y,C[p+9],x,3951481745),y=n(y,d),_=n(_,g),A=n(A,v),T=n(T,E);return(f(y)+f(_)+f(A)+f(T)).toLowerCase()},e.getFixedWidthText=function(t,e,n,r,i){t=t||"",e=e||24,n=n||60,r=r||"Arial";var o="",a=null;a||(a=new eui.Label),i&&(n+=i),a.fontFamily=r,a.size=e;for(var s="",u=t.length,c=0;u>c;c++){var l=t.substr(0,c+1);if(a.text=l,a.width>=n){o=s;break}o=s=l}if(/^([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôû\-\_]+\s+)+[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôû\-\_]+$/.test(o)){var h=o.search(/\s+[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôû\-\_]+$/);if(-1!=h){var f=o.substr(h);f=f.replace(/\s+/g,""),f=f.charAt(0).toUpperCase(),o=o.substring(0,h)+" "+f}}return o},e.mathPhizCount=function(t){var e=/[\ud800-\udbff][\udc00-\udfff]/g,n=t.match(e),r=0;return n&&(r=n.length),r},e.encodeUTF16=function(t){var e=/[\ud800-\udbff][\udc00-\udfff]/g;return t=t.replace(e,function(t){return 2===t.length?encodeURI(t):t})},e.toBinaryString=function(t,e){t=t||0;var n=t.toString(2);if(n.length<e)for(var r=e-n.length,i=0;r>i;i++)n="0"+n;return n},e.getUrlParams=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=location&&location.search&&location.search.substr(1).match(e);return n&&n.length>=2?decodeURIComponent(n[2]):null},e.getObjFromParams=function(t){if(!t||""===t)return{};for(var e=t.split("&"),n={},r=0;r<e.length;r++){var i=e[r].split("=");n[i[0]]=i[1]}return n},e.getCurrentTimeStr=function(t){var e="",n=new Date(1e3*~~t),r=n.getHours(),i=n.getMinutes(),t=n.getSeconds(),o=function(t){return 10>t?"0"+t:t
};return r=o(r),i=o(i),t=o(t),e=r+":"+i+":"+t},e.convertRewardJson=function(t){var e={};if(!t||t.length<=0)return e;for(var n=0;n<t.length;n++)e[t[n].name]=t[n].count;return e},e.randomPick=function(t){return t[~~(Math.random()*t.length)]||null},e.getBezier=function(t,e,n){return function(r){var i=1-(r=Math.min(1,r));return{x:i*i*t.x+2*r*i*e.x+r*r*n.x,y:i*i*t.y+2*r*i*e.y+r*r*n.y}}},e.LoadJS=function(t){var e=document.getElementsByTagName("HEAD").item(0),n=document.createElement("SCRIPT");n.src=t,n.type="text/javascript",e.appendChild(n)},e.reverseObj=function(t){if(t){var e=[],n=[];for(var r in t)e.push(r),n.push(t[r]);for(var i={},o=e.length-1;o>=0;o--)i[e[o]]=n[o];return i}},e.propString2Number=function(t,n){if(t&&e.isObject(t)&&n&&(e.isString(n)&&(n=[n]),e.isArray(n))){for(var r={},i=0;i<n.length;i++)r["."+n[i]]=!0;e.enumProp(t,r)}},e.enumProp=function(t,n,r,i){if(r=r||"",t&&e.isArray(t))for(var o=0;o<t.length;o++)e.enumProp(t[o],r+"[]",function(t){this.json[this.i]=t}.bind({json:t,i:o}));else if(t&&e.isObject(t))for(var a in t)e.enumProp(t[a],r+"."+a,function(t){this.json[this.key]=t}.bind({json:t,key:a}));else if(null!=t&&e.isString(t)&&n[r]&&i){var s=Number(t);isNaN(s)||i(s)}},e.filterArr=function(t,n,r,i){if(!t||!n||!r)return r;if(t=t||"",t=t.toLowerCase(),t=t.replace(/^\s+/,""),t=t.replace(/\s+$/,""),!t||""==t)return r;for(var o=[],a=0;a<r.length;a++){var s=r[a];if(i){if(!s[i]||!s[i][n]||!e.isString(s[i][n]))continue}else if(!s[n]||!e.isString(s[n]))continue;var u=void 0;u=i?s[i][n].toLowerCase():s[n].toLowerCase(),-1!=u.indexOf(t)&&-1==o.indexOf(u)&&o.push(s)}return o},e.getCurrFullDate=function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return e+"-"+n+"-"+r},e.makeNodeToTexture=function(t,e){if(!t)return null;var n=new egret.RenderTexture,r=e||t.getBounds();return r.width&&r.height||(r.width=t.width,r.height=t.height),n.drawToTexture(t,r),n},e.makeTextureToGrey=function(t){if(t){var n=new egret.DisplayObjectContainer,r=new eui.Image;return r.source=t,e.setGrey(r),n.addChild(r),e.makeNodeToTexture(n)}},e.deepCloneObj=function(t){var n={};t instanceof Array&&(n=[]);for(var r in t){var i=t[r];n[r]="object"==typeof i?e.deepCloneObj(i):i}return n},e.initLocalStorage=function(){window.localStorage.getItem("timestamp")||window.localStorage.setItem("timestamp",e.getCurrFullDate());var t=window.localStorage.getItem("timestamp");t!==e.getCurrFullDate()&&(window.localStorage.clear(),window.localStorage.setItem("timestamp",e.getCurrFullDate()))},e.intersectArea=function(t,e,n,r,i,o){var a,s,u,c,l;return c=Math.sqrt((r-t)*(r-t)+(i-e)*(i-e)),c>=n+o?l=0:c<=Math.abs(n-o)?l=o>=n?Math.PI*n*n:Math.PI*o*o:(u=(c+n+o)/2,a=2*Math.sqrt(u*(u-c)*(u-n)*(u-o)),n>o&&(s=t,t=r,r=s,s=e,e=i,i=s,s=n,n=o,o=s),l=Math.acos((n*n+c*c-o*o)/(2*n*c))*n*n+Math.acos((o*o+c*c-n*n)/(2*o*c))*o*o-a),l},e.IsPC=function(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,r=0;r<e.length;r++)if(t.indexOf(e[r])>0){n=!1;break}return n},e.getStringLength=function(t){for(var e=0,n=0;e<t.length;){var r=t.charCodeAt(e);r>255?n+=2:n++,e++}return n},e.subString=function(t,e){for(var n=0,r=0,i="";n<t.length&&e>r;){var o=t.charCodeAt(n);o>255?r+=2:r++,i+=t.charAt(n),n++}return i},e.compareVersion=function(t,e){if(t=t.trim(),e=e.trim(),""===t||""===e)return null;if(t===e)return 0;for(var n=t.split("."),r=e.split("."),i=0;i<n.length;i++){var o=n[i],a=r[i];if(o&&a){if(parseFloat(o)>parseFloat(a))return 1;if(parseFloat(o)<parseFloat(a))return-1}}return n.length>r.length?1:-1},e.setTargetAnchorOffset=function(t,e){void 0===e&&(e=.5),t&&(t.anchorOffsetX=t.width*e,t.anchorOffsetY=t.height*e,t.x+=t.anchorOffsetX,t.y+=t.anchorOffsetY)},e.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e}();t.Util=e,__reflect(e.prototype,"adapter.Util")}(adapter||(adapter={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function r(r){e.call(n,r,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?r(i):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var acg;!function(t){var e=function(){function e(){}return e.init=function(t){e.stage=t,e.sceneLayer=new egret.Sprite,e.effectLayer=new egret.Sprite,e.uiLayer=new egret.Sprite,t.addChild(e.sceneLayer),t.addChild(e.effectLayer),t.addChild(e.uiLayer)},e.start=function(){e.menu||(e.menu=new t.MenuView),e.sceneLayer.addChild(e.menu)},e}();t.LayerManager=e,__reflect(e.prototype,"acg.LayerManager")}(acg||(acg={}));var acg;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.site="http://localhost:5000",e.isEraser=!1,e.strokeList=[],e.skinName="BoardViewSkin",e}return __extends(e,t),e.prototype.initComponent=function(){this.board||(this.board=new egret.Sprite,this.board.width=this.width,this.board.height=this.height),this.addChildAt(this.board,1)},e.prototype.initData=function(){},e.prototype.initListener=function(){this.addClickEvent(this.backBtn,this.back,this),this.addClickEvent(this.penBtn,this.changePan,this),this.addClickEvent(this.eraserBtn,this.changeEraser,this),this.addClickEvent(this.clearBtn,this.clearBoard,this),this.addEvent(this.bgImg,egret.TouchEvent.TOUCH_BEGIN,this.startDraw,this)},e.prototype.startDraw=function(t){this.bgImg.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.move,this),this.bgImg.addEventListener(egret.TouchEvent.TOUCH_END,this.moveEnd,this),this.isEraser?this.board.graphics.lineStyle(20,16777215):this.board.graphics.lineStyle(10,0),this.lastX=t.stageX,this.lastY=t.stageY,this.tempStroke=[[this.lastX],[this.lastY]],this.timer||(this.timer=new egret.Timer(200,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this)),this.timer.start()},e.prototype.timerFunc=function(){this.tempStroke[0].push(this.lastX),this.tempStroke[1].push(this.lastY)},e.prototype.move=function(t){this.board.graphics.moveTo(this.lastX,this.lastY),this.lastX=t.stageX,this.lastY=t.stageY,this.board.graphics.lineTo(this.lastX,this.lastY)},e.prototype.moveEnd=function(t){this.bgImg.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.move,this),this.bgImg.removeEventListener(egret.TouchEvent.TOUCH_END,this.moveEnd,this),this.tempStroke[0].push(t.stageX),this.tempStroke[1].push(t.stageY),this.strokeList.push(this.tempStroke),this.timer.stop(),this.reqStroke()},e.prototype.changePan=function(){this.isEraser=!1},e.prototype.changeEraser=function(){},e.prototype.clearBoard=function(){this.board.graphics.clear(),this.strokeList=[]},e.prototype.reqStroke=function(){var t=JSON.stringify(this.strokeList),e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(this.site,egret.HttpMethod.POST),e.setRequestHeader("Content-Type","application/json"),e.send(t),console.log(t),e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this)},e.prototype.onGetComplete=function(t){var e=t.currentTarget;alert("get data : "+JSON.stringify(e.response))},e.prototype.onGetIOError=function(t){alert("get error")},e.prototype.back=function(){this.clearBoard(),this.parent.removeChild(this)},e}(t.BaseView);t.BoardView=e,__reflect(e.prototype,"acg.BoardView")}(acg||(acg={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var acg;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="MenuView",t}return __extends(n,e),n.prototype.initComponent=function(){this.ani=new adapter.ArmatureAnimation,this.ani.initWithName("CJ3"),this.addChild(this.ani),this.ani.x=800,this.ani.y=800,this.showAni1Handler()},n.prototype.initData=function(){},n.prototype.initListener=function(){this.addClickEvent(this.boardBtn,this.showBoardHandler,this),this.addClickEvent(this.photoBtn,this.showPhotoHandler,this),this.addClickEvent(this.ani1Btn,this.showAni1Handler,this),this.addClickEvent(this.ani2Btn,this.showAni2Handler,this)},n.prototype.showAni1Handler=function(){this.ani.setAnimation(0,"CJ3_p1",!0)},n.prototype.showAni2Handler=function(){this.ani.setAnimation(0,"CJ3_p2",!0)},n.prototype.showBoardHandler=function(){this.boardView||(this.boardView=new t.BoardView),t.LayerManager.uiLayer.addChild(this.boardView)},n.prototype.showPhotoHandler=function(){egret.ExternalInterface.call("takePhoto","message from JS")},n}(t.BaseView);t.MenuView=e,__reflect(e.prototype,"acg.MenuView")}(acg||(acg={}));